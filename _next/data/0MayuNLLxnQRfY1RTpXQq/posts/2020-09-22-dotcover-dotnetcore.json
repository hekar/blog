{"pageProps":{"post":{"title":"Dotcover in Dotnet Core","date":"2020-09-22","slug":"2020-09-22-dotcover-dotnetcore","content":"<p>Code coverage can be a useful heuristic for determining whether code is adequately executed by a given set of unit tests.</p>\n<p>Tooling that produces code coverage will never be able to inform you how well your assertions are executed or if the given execution is necessary, but they will you an about whether a portion of code is covered by tests at all.</p>\n<hr>\n<p>For <a href=\"https://dotnet.microsoft.com/download/dotnet-core\">Dotnet Core</a> applications I have been using a tool by <a href=\"https://www.jetbrains.com/\">Jetbrains</a> called <a href=\"https://www.jetbrains.com/dotcover/\">Dotcover</a>.</p>\n<p><a href=\"https://www.jetbrains.com/dotcover/\">Dotcover</a> integrates with <a href=\"https://docs.microsoft.com/en-us/dotnet/core/testing/unit-testing-with-mstest\">MSTest</a>, <a href=\"https://nunit.org/\">NUnit</a>, <a href=\"https://xunit.net/\">xUnit</a>, and <a href=\"https://github.com/machine/machine.specifications\">MSpec</a>. It can be executed through the <a href=\"https://www.jetbrains.com/help/dotcover/Running_Coverage_Analysis_from_the_Command_LIne.html\">command-line</a> or <a href=\"https://visualstudio.microsoft.com/\">Visual Studio</a>.</p>\n<h2>Create Project</h2>\n<p>If you do not have an existing project, you can create one use the templates provided for dotnet.</p>\n<p>These commands below will create a project, test project and solution file. The test project will reference the project and the solution file will contain both the projects.</p>\n<pre><code class=\"hljs language-sh\"><span class=\"hljs-built_in\">mkdir</span> project\n<span class=\"hljs-built_in\">cd</span> project\ndotnet new console --name ConsoleApp\ndotnet new xunit --name ConsoleApp.Tests\n<span class=\"hljs-built_in\">cd</span> ConsoleApp.Tests\ndotnet add reference ../ConsoleApp/ConsoleApp.csproj\n<span class=\"hljs-built_in\">cd</span> ..\ndotnet new sln --name ConsoleApp\ndotnet sln add ConsoleApp ConsoleApp.Tests\n</code></pre>\n<h2>Add Dotcover</h2>\n<p>To reference Dotcover in the unit test project, open <code>./ConsoleApp.Tests/ConsoleApp.Tests.csproj</code> in a text editor. Add the following:</p>\n<pre><code class=\"hljs language-xml\">  <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ItemGroup</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">DotNetCliToolReference</span> <span class=\"hljs-attr\">Include</span>=<span class=\"hljs-string\">\"JetBrains.dotCover.DotNetCliTool\"</span> <span class=\"hljs-attr\">Version</span>=<span class=\"hljs-string\">\"2020.2.3\"</span> /></span>\n  <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ItemGroup</span>></span>\n</code></pre>\n<p>run</p>\n<pre><code class=\"hljs language-sh\">dotnet restore\n</code></pre>\n<h2>Run dotcover</h2>\n<p>The default dotcover configuration outputs a <code>.dcvr</code> file.</p>\n<pre><code class=\"hljs language-sh\">dotnet dotcover <span class=\"hljs-built_in\">test</span>\n</code></pre>\n<h2>Additional configuration</h2>\n<p>This step is entirely optional, but you can create a file for dotcover configuration.</p>\n<pre><code class=\"hljs language-sh\">dotnet dotcover <span class=\"hljs-built_in\">test</span> --dotCoverXml=dotcover.xml\n</code></pre>\n<p>dotcover.xml</p>\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">AnalyzeParams</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">Output</span>></span>dotCover.html<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">Output</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ReportType</span>></span>html<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ReportType</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">AttributeFilters</span>></span>\n        <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">AttributeFilterEntry</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ClassMask</span>></span>System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ClassMask</span>></span>\n        <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">AttributeFilterEntry</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">AttributeFilters</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">Scope</span>></span>\n        <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ScopeEntry</span>></span>../ConsoleApp/**/*.dll<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ScopeEntry</span>></span>\n        <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ScopeEntry</span>></span>../ConsoleApp/**/*.exe<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ScopeEntry</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">Scope</span>></span>\n    <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">Filters</span>></span>\n        <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ExcludeFilters</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">FilterEntry</span>></span>\n                <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ModuleMask</span>></span>ConsoleApp.Tests<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ModuleMask</span>></span>\n            <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">FilterEntry</span>></span>\n            <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">FilterEntry</span>></span>\n                <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">ModuleMask</span>></span>xunit.assert<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ModuleMask</span>></span>\n            <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">FilterEntry</span>></span>\n        <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">ExcludeFilters</span>></span>\n    <span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">Filters</span>></span>\n<span class=\"hljs-tag\">&#x3C;/<span class=\"hljs-name\">AnalyzeParams</span>></span>\n</code></pre>\n<p>open <code>ConsoleApp.Tests/dotcover.html</code> to see the final coverage report</p>\n<p><img src=\"https://i.imgur.com/v8l1RKb.png\" alt=\"example-coverage-report\"></p>\n<h2>Conclusion</h2>\n<p>Dotcover is easy to setup and configure with Dotnet Core projects. The project works well after basic configuration. The only issue is the license is not a standard</p>\n<p>For an example of a project using dotcover, checkout <a href=\"https://github.com/hekar/joke-generator\">hekar/joke-generator</a>.</p>"}},"__N_SSG":true}